import{S as Mi,i as Gi,s as Fi,e as i,k as h,w as d,t as r,M as Li,c as l,d as t,m as p,a as u,x as m,h as a,b as f,N as Js,G as o,g as n,y as g,q as w,o as _,B as b,v as Wi}from"../../chunks/vendor-hf-doc-builder.js";import{T as wn}from"../../chunks/Tip-hf-doc-builder.js";import{Y as _n}from"../../chunks/Youtube-hf-doc-builder.js";import{I as bn}from"../../chunks/IconCopyLink-hf-doc-builder.js";import{C as y}from"../../chunks/CodeBlock-hf-doc-builder.js";import{D as Qi}from"../../chunks/DocNotebookDropdown-hf-doc-builder.js";function Yi(U){let c,q;return{c(){c=i("p"),q=r("\u{1F6A8} See that blue box around \u201C6 frames\u201D in the traceback from Google Colab? That\u2019s a special feature of Colab, which  compresses the traceback into \u201Cframes.\u201D If you can\u2019t seem to find the source of an error, make sure you expand the full traceback by clicking on those two little arrows.")},l(k){c=l(k,"P",{});var $=u(c);q=a($,"\u{1F6A8} See that blue box around \u201C6 frames\u201D in the traceback from Google Colab? That\u2019s a special feature of Colab, which  compresses the traceback into \u201Cframes.\u201D If you can\u2019t seem to find the source of an error, make sure you expand the full traceback by clicking on those two little arrows."),$.forEach(t)},m(k,$){n(k,c,$),o(c,q)},d(k){k&&t(c)}}}function Ri(U){let c,q,k,$,D,v,T,A,H,X,N;return{c(){c=i("p"),q=r("\u{1F4A1} If you encounter an error message that is difficult to understand, just copy and paste the message into the Google or "),k=i("a"),$=r("Stack Overflow"),D=r(" search bar (yes, really!). There\u2019s a good chance that you\u2019re not the first person to encounter the error, and this is a good way to find solutions that others in the community have posted. For example, searching for "),v=i("code"),T=r("OSError: Can't load config for"),A=r(" on Stack Overflow gives several "),H=i("a"),X=r("hits"),N=r(" that could be used as a starting point for solving the problem."),this.h()},l(M){c=l(M,"P",{});var E=u(c);q=a(E,"\u{1F4A1} If you encounter an error message that is difficult to understand, just copy and paste the message into the Google or "),k=l(E,"A",{href:!0,rel:!0});var it=u(k);$=a(it,"Stack Overflow"),it.forEach(t),D=a(E," search bar (yes, really!). There\u2019s a good chance that you\u2019re not the first person to encounter the error, and this is a good way to find solutions that others in the community have posted. For example, searching for "),v=l(E,"CODE",{});var B=u(v);T=a(B,"OSError: Can't load config for"),B.forEach(t),A=a(E," on Stack Overflow gives several "),H=l(E,"A",{href:!0,rel:!0});var lt=u(H);X=a(lt,"hits"),lt.forEach(t),N=a(E," that could be used as a starting point for solving the problem."),E.forEach(t),this.h()},h(){f(k,"href","https://stackoverflow.com/"),f(k,"rel","nofollow"),f(H,"href","https://stackoverflow.com/search?q=OSError%3A+Can%27t+load+config+for+"),f(H,"rel","nofollow")},m(M,E){n(M,c,E),o(c,q),o(c,k),o(k,$),o(c,D),o(c,v),o(v,T),o(c,A),o(c,H),o(H,X),o(c,N)},d(M){M&&t(c)}}}function Bi(U){let c,q,k,$,D;return{c(){c=i("p"),q=r("\u{1F6A8} The approach we\u2019re taking here is not foolproof, since our colleague may have tweaked the configuration of "),k=i("code"),$=r("distilbert-base-uncased"),D=r(" before fine-tuning the model. In real life, we\u2019d want to check with them first, but for the purposes of this section we\u2019ll assume they used the default configuration.")},l(v){c=l(v,"P",{});var T=u(c);q=a(T,"\u{1F6A8} The approach we\u2019re taking here is not foolproof, since our colleague may have tweaked the configuration of "),k=l(T,"CODE",{});var A=u(k);$=a(A,"distilbert-base-uncased"),A.forEach(t),D=a(T," before fine-tuning the model. In real life, we\u2019d want to check with them first, but for the purposes of this section we\u2019ll assume they used the default configuration."),T.forEach(t)},m(v,T){n(v,c,T),o(c,q),o(c,k),o(k,$),o(c,D)},d(v){v&&t(c)}}}function Vi(U){let c,q,k,$,D,v,T,A,H,X,N,M,E,it,B,lt,Us,bo,de,ko,G,Xs,me,Ks,Zs,ge,er,tr,yo,we,$o,ut,or,vo,_e,Eo,K,sr,Pt,rr,ar,qo,be,xo,Z,nr,Dt,ir,lr,jo,V,ee,At,ke,ur,It,hr,To,ht,pr,Co,pt,ye,fr,ft,cr,dr,Po,te,mr,Ot,gr,wr,Do,$e,Ao,ve,Io,F,_r,St,br,kr,zt,yr,$r,Oo,Ee,qe,kn,So,C,vr,Ht,Er,qr,Nt,xr,jr,ct,Tr,Cr,Mt,Pr,Dr,zo,oe,Ho,L,Ar,Gt,Ir,Or,Ft,Sr,zr,No,xe,Mo,se,Go,dt,Hr,Fo,je,Te,yn,Lo,mt,Nr,Wo,Ce,Pe,$n,Qo,gt,Mr,Yo,De,Ro,Ae,Bo,W,Gr,Lt,Fr,Lr,Wt,Wr,Qr,Vo,Ie,Jo,Oe,Uo,x,Yr,Qt,Rr,Br,Yt,Vr,Jr,Se,Rt,Ur,Xr,wt,Kr,Zr,Bt,ea,ta,Xo,ze,Ko,re,Zo,ae,oa,Vt,sa,ra,es,He,ts,ne,aa,Jt,na,ia,os,Ne,ss,Me,rs,_t,la,as,I,Ge,ua,Ut,ha,pa,fa,Xt,ca,da,Kt,ma,ga,Fe,wa,Zt,_a,ba,ns,bt,ka,is,J,ie,eo,Le,ya,to,$a,ls,Q,va,oo,Ea,qa,so,xa,ja,us,We,hs,kt,Ta,ps,Qe,fs,le,Ca,yt,Pa,Da,cs,Ye,ds,Re,ms,$t,Aa,gs,Be,ws,vt,Ia,_s,Ve,bs,P,Oa,ro,Sa,za,ao,Ha,Na,no,Ma,Ga,io,Fa,La,ks,Je,ys,Ue,$s,ue,Wa,lo,Qa,Ya,vs,Xe,Es,Ke,qs,j,Ra,uo,Ba,Va,Et,Ja,Ua,ho,Xa,Ka,po,Za,en,fo,tn,on,xs,Ze,js,O,sn,co,rn,an,mo,nn,ln,et,un,hn,Ts,tt,ot,vn,Cs,he,pn,go,fn,cn,Ps,st,Ds,rt,As,pe,dn,at,mn,gn,Is;return v=new bn({}),N=new Qi({props:{classNames:"absolute z-10 right-0 top-0",options:[{label:"Google Colab",value:"https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter8/section2.ipynb"},{label:"Aws Studio",value:"https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter8/section2.ipynb"}]}}),de=new _n({props:{id:"DQ-CpJn6Rc4"}}),we=new y({props:{code:"",highlighted:`<span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()`}}),_e=new y({props:{code:"huggingface-cli login",highlighted:"huggingface-cli login"}}),be=new y({props:{code:`
`,highlighted:`<span class="hljs-keyword">from</span> distutils.dir_util <span class="hljs-keyword">import</span> copy_tree
<span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository, snapshot_download, create_repo, get_full_repo_name


<span class="hljs-keyword">def</span> <span class="hljs-title function_">copy_repository_template</span>():
    <span class="hljs-comment"># Clone the repo and extract the local path</span>
    template_repo_id = <span class="hljs-string">&quot;lewtun/distilbert-base-uncased-finetuned-squad-d5716d28&quot;</span>
    commit_hash = <span class="hljs-string">&quot;be3eaffc28669d7932492681cd5f3e8905e358b4&quot;</span>
    template_repo_dir = snapshot_download(template_repo_id, revision=commit_hash)
    <span class="hljs-comment"># Create an empty repo on the Hub</span>
    model_name = template_repo_id.split(<span class="hljs-string">&quot;/&quot;</span>)[<span class="hljs-number">1</span>]
    create_repo(model_name, exist_ok=<span class="hljs-literal">True</span>)
    <span class="hljs-comment"># Clone the empty repo</span>
    new_repo_id = get_full_repo_name(model_name)
    new_repo_dir = model_name
    repo = Repository(local_dir=new_repo_dir, clone_from=new_repo_id)
    <span class="hljs-comment"># Copy files</span>
    copy_tree(template_repo_dir, new_repo_dir)
    <span class="hljs-comment"># Push to Hub</span>
    repo.push_to_hub()`}}),ke=new bn({}),$e=new y({props:{code:"",highlighted:`<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

model_checkpoint = get_full_repo_name(<span class="hljs-string">&quot;distillbert-base-uncased-finetuned-squad-d5716d28&quot;</span>)
reader = pipeline(<span class="hljs-string">&quot;question-answering&quot;</span>, model=model_checkpoint)`}}),ve=new y({props:{code:`
`,highlighted:`<span class="hljs-string">&quot;&quot;&quot;
OSError: Can&#x27;t load config for &#x27;lewtun/distillbert-base-uncased-finetuned-squad-d5716d28&#x27;. Make sure that:

- &#x27;lewtun/distillbert-base-uncased-finetuned-squad-d5716d28&#x27; is a correct model identifier listed on &#x27;https://huggingface.co/models&#x27;

- or &#x27;lewtun/distillbert-base-uncased-finetuned-squad-d5716d28&#x27; is the correct path to a directory containing a config.json file
&quot;&quot;&quot;</span>`}}),oe=new wn({props:{$$slots:{default:[Yi]},$$scope:{ctx:U}}}),xe=new y({props:{code:`
`,highlighted:`<span class="hljs-string">&quot;&quot;&quot;
Make sure that:

- &#x27;lewtun/distillbert-base-uncased-finetuned-squad-d5716d28&#x27; is a correct model identifier listed on &#x27;https://huggingface.co/models&#x27;

- or &#x27;lewtun/distillbert-base-uncased-finetuned-squad-d5716d28&#x27; is the correct path to a directory containing a config.json file
&quot;&quot;&quot;</span>`}}),se=new wn({props:{$$slots:{default:[Ri]},$$scope:{ctx:U}}}),De=new y({props:{code:`model_checkpoint = get_full_repo_name("distilbert-base-uncased-finetuned-squad-d5716d28")
reader = pipeline("question-answering", model=model_checkpoint)`,highlighted:`model_checkpoint = get_full_repo_name(<span class="hljs-string">&quot;distilbert-base-uncased-finetuned-squad-d5716d28&quot;</span>)
reader = pipeline(<span class="hljs-string">&quot;question-answering&quot;</span>, model=model_checkpoint)`}}),Ae=new y({props:{code:`
`,highlighted:`<span class="hljs-string">&quot;&quot;&quot;
OSError: Can&#x27;t load config for &#x27;lewtun/distilbert-base-uncased-finetuned-squad-d5716d28&#x27;. Make sure that:

- &#x27;lewtun/distilbert-base-uncased-finetuned-squad-d5716d28&#x27; is a correct model identifier listed on &#x27;https://huggingface.co/models&#x27;

- or &#x27;lewtun/distilbert-base-uncased-finetuned-squad-d5716d28&#x27; is the correct path to a directory containing a config.json file
&quot;&quot;&quot;</span>`}}),Ie=new y({props:{code:"",highlighted:`<span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> list_repo_files

list_repo_files(repo_id=model_checkpoint)`}}),Oe=new y({props:{code:"['.gitattributes', 'README.md', 'pytorch_model.bin', 'special_tokens_map.json', 'tokenizer_config.json', 'training_args.bin', 'vocab.txt']",highlighted:'[<span class="hljs-string">&#x27;.gitattributes&#x27;</span>, <span class="hljs-string">&#x27;README.md&#x27;</span>, <span class="hljs-string">&#x27;pytorch_model.bin&#x27;</span>, <span class="hljs-string">&#x27;special_tokens_map.json&#x27;</span>, <span class="hljs-string">&#x27;tokenizer_config.json&#x27;</span>, <span class="hljs-string">&#x27;training_args.bin&#x27;</span>, <span class="hljs-string">&#x27;vocab.txt&#x27;</span>]'}}),ze=new y({props:{code:"",highlighted:`<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoConfig

pretrained_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
config = AutoConfig.from_pretrained(pretrained_checkpoint)`}}),re=new wn({props:{warning:!0,$$slots:{default:[Bi]},$$scope:{ctx:U}}}),He=new y({props:{code:'config.push_to_hub(model_checkpoint, commit_message="Add config.json")',highlighted:'config.push_to_hub(model_checkpoint, commit_message=<span class="hljs-string">&quot;Add config.json&quot;</span>)'}}),Ne=new y({props:{code:`

`,highlighted:`reader = pipeline(<span class="hljs-string">&quot;question-answering&quot;</span>, model=model_checkpoint, revision=<span class="hljs-string">&quot;main&quot;</span>)

context = <span class="hljs-string">r&quot;&quot;&quot;
Extractive Question Answering is the task of extracting an answer from a text
given a question. An example of a question answering dataset is the SQuAD
dataset, which is entirely based on that task. If you would like to fine-tune a
model on a SQuAD task, you may leverage the
examples/pytorch/question-answering/run_squad.py script.

\u{1F917} Transformers is interoperable with the PyTorch, TensorFlow, and JAX
frameworks, so you can use your favourite tools for a wide variety of tasks!
&quot;&quot;&quot;</span>

question = <span class="hljs-string">&quot;What is extractive question answering?&quot;</span>
reader(question=question, context=context)`}}),Me=new y({props:{code:`{'score': 0.38669535517692566,
 'start': 34,
 'end': 95,
 'answer': 'the task of extracting an answer from a text given a question'}`,highlighted:`{<span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.38669535517692566</span>,
 <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">34</span>,
 <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">95</span>,
 <span class="hljs-string">&#x27;answer&#x27;</span>: <span class="hljs-string">&#x27;the task of extracting an answer from a text given a question&#x27;</span>}`}}),Le=new bn({}),We=new y({props:{code:`tokenizer = reader.tokenizer
model = reader.model`,highlighted:`tokenizer = reader.tokenizer
model = reader.model`}}),Qe=new y({props:{code:'question = "Which frameworks can I use?"',highlighted:'question = <span class="hljs-string">&quot;Which frameworks can I use?&quot;</span>'}}),Ye=new y({props:{code:"",highlighted:`<span class="hljs-keyword">import</span> torch

inputs = tokenizer(question, context, add_special_tokens=<span class="hljs-literal">True</span>)
input_ids = inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][<span class="hljs-number">0</span>]
outputs = model(**inputs)
answer_start_scores = outputs.start_logits
answer_end_scores = outputs.end_logits
<span class="hljs-comment"># Get the most likely beginning of answer with the argmax of the score</span>
answer_start = torch.argmax(answer_start_scores)
<span class="hljs-comment"># Get the most likely end of answer with the argmax of the score</span>
answer_end = torch.argmax(answer_end_scores) + <span class="hljs-number">1</span>
answer = tokenizer.convert_tokens_to_string(
    tokenizer.convert_ids_to_tokens(input_ids[answer_start:answer_end])
)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Question: <span class="hljs-subst">{question}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Answer: <span class="hljs-subst">{answer}</span>&quot;</span>)`}}),Re=new y({props:{code:`



`,highlighted:`<span class="hljs-string">&quot;&quot;&quot;
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
/var/folders/28/k4cy5q7s2hs92xq7_h89_vgm0000gn/T/ipykernel_75743/2725838073.py in &lt;module&gt;
      1 inputs = tokenizer(question, text, add_special_tokens=True)
      2 input_ids = inputs[&quot;input_ids&quot;]
----&gt; 3 outputs = model(**inputs)
      4 answer_start_scores = outputs.start_logits
      5 answer_end_scores = outputs.end_logits

~/miniconda3/envs/huggingface/lib/python3.8/site-packages/torch/nn/modules/module.py in _call_impl(self, *input, **kwargs)
   1049         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks
   1050                 or _global_forward_hooks or _global_forward_pre_hooks):
-&gt; 1051             return forward_call(*input, **kwargs)
   1052         # Do not call functions when jit is used
   1053         full_backward_hooks, non_full_backward_hooks = [], []

~/miniconda3/envs/huggingface/lib/python3.8/site-packages/transformers/models/distilbert/modeling_distilbert.py in forward(self, input_ids, attention_mask, head_mask, inputs_embeds, start_positions, end_positions, output_attentions, output_hidden_states, return_dict)
    723         return_dict = return_dict if return_dict is not None else self.config.use_return_dict
    724
--&gt; 725         distilbert_output = self.distilbert(
    726             input_ids=input_ids,
    727             attention_mask=attention_mask,

~/miniconda3/envs/huggingface/lib/python3.8/site-packages/torch/nn/modules/module.py in _call_impl(self, *input, **kwargs)
   1049         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks
   1050                 or _global_forward_hooks or _global_forward_pre_hooks):
-&gt; 1051             return forward_call(*input, **kwargs)
   1052         # Do not call functions when jit is used
   1053         full_backward_hooks, non_full_backward_hooks = [], []

~/miniconda3/envs/huggingface/lib/python3.8/site-packages/transformers/models/distilbert/modeling_distilbert.py in forward(self, input_ids, attention_mask, head_mask, inputs_embeds, output_attentions, output_hidden_states, return_dict)
    471             raise ValueError(&quot;You cannot specify both input_ids and inputs_embeds at the same time&quot;)
    472         elif input_ids is not None:
--&gt; 473             input_shape = input_ids.size()
    474         elif inputs_embeds is not None:
    475             input_shape = inputs_embeds.size()[:-1]

AttributeError: &#x27;list&#x27; object has no attribute &#x27;size&#x27;
&quot;&quot;&quot;</span>`}}),Be=new _n({props:{id:"rSPyvPw0p9k"}}),Ve=new _n({props:{id:"5PkZ4rbHL6c"}}),Je=new y({props:{code:'inputs["input_ids"][:5]',highlighted:'inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][:<span class="hljs-number">5</span>]'}}),Ue=new y({props:{code:"[101, 2029, 7705, 2015, 2064]",highlighted:'[<span class="hljs-number">101</span>, <span class="hljs-number">2029</span>, <span class="hljs-number">7705</span>, <span class="hljs-number">2015</span>, <span class="hljs-number">2064</span>]'}}),Xe=new y({props:{code:'type(inputs["input_ids"])',highlighted:'<span class="hljs-built_in">type</span>(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])'}}),Ke=new y({props:{code:"list",highlighted:'<span class="hljs-built_in">list</span>'}}),Ze=new y({props:{code:"",highlighted:`~<span class="hljs-regexp">/miniconda3/</span>envs<span class="hljs-regexp">/huggingface/</span>lib<span class="hljs-regexp">/python3.8/</span>site-packages<span class="hljs-regexp">/transformers/m</span>odels<span class="hljs-regexp">/distilbert/m</span>odeling_distilbert.py in forward(self, input_ids, attention_mask, head_mask, inputs_embeds, output_attentions, output_hidden_states, return_dict)
    <span class="hljs-number">471</span>             raise ValueError(<span class="hljs-string">&quot;You cannot specify both input_ids and inputs_embeds at the same time&quot;</span>)
    <span class="hljs-number">472</span>         elif input_ids is not None:
--&gt; <span class="hljs-number">473</span>             input_shape = input_ids.<span class="hljs-keyword">size</span>()
    <span class="hljs-number">474</span>         elif inputs_embeds is not None:
    <span class="hljs-number">475</span>             input_shape = inputs_embeds.<span class="hljs-keyword">size</span>()[:-<span class="hljs-number">1</span>]

AttributeError: <span class="hljs-string">&#x27;list&#x27;</span> object has no attribute <span class="hljs-string">&#x27;size&#x27;</span>`}}),st=new y({props:{code:`inputs = tokenizer(question, context, add_special_tokens=True, return_tensors="pt")
input_ids = inputs["input_ids"][0]
outputs = model(**inputs)
answer_start_scores = outputs.start_logits
answer_end_scores = outputs.end_logits
# Get the most likely beginning of answer with the argmax of the score
answer_start = torch.argmax(answer_start_scores)
# Get the most likely end of answer with the argmax of the score
answer_end = torch.argmax(answer_end_scores) + 1
answer = tokenizer.convert_tokens_to_string(
    tokenizer.convert_ids_to_tokens(input_ids[answer_start:answer_end])
)
print(f"Question: {question}")
print(f"Answer: {answer}")`,highlighted:`inputs = tokenizer(question, context, add_special_tokens=<span class="hljs-literal">True</span>, return_tensors=<span class="hljs-string">&quot;pt&quot;</span>)
input_ids = inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][<span class="hljs-number">0</span>]
outputs = model(**inputs)
answer_start_scores = outputs.start_logits
answer_end_scores = outputs.end_logits
<span class="hljs-comment"># Get the most likely beginning of answer with the argmax of the score</span>
answer_start = torch.argmax(answer_start_scores)
<span class="hljs-comment"># Get the most likely end of answer with the argmax of the score</span>
answer_end = torch.argmax(answer_end_scores) + <span class="hljs-number">1</span>
answer = tokenizer.convert_tokens_to_string(
    tokenizer.convert_ids_to_tokens(input_ids[answer_start:answer_end])
)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Question: <span class="hljs-subst">{question}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Answer: <span class="hljs-subst">{answer}</span>&quot;</span>)`}}),rt=new y({props:{code:`"""
Question: Which frameworks can I use?
Answer: pytorch, tensorflow, and jax
"""`,highlighted:`<span class="hljs-string">&quot;&quot;&quot;
Question: Which frameworks can I use?
Answer: pytorch, tensorflow, and jax
&quot;&quot;&quot;</span>`}}),{c(){c=i("meta"),q=h(),k=i("h1"),$=i("a"),D=i("span"),d(v.$$.fragment),T=h(),A=i("span"),H=r("What to do when you get an error"),X=h(),d(N.$$.fragment),M=h(),E=i("p"),it=r("In this section we\u2019ll look at some common errors that can occur when you\u2019re trying to generate predictions from your freshly tuned Transformer model. This will prepare you for "),B=i("a"),lt=r("section 4"),Us=r(", where we\u2019ll explore how to debug the training phase itself."),bo=h(),d(de.$$.fragment),ko=h(),G=i("p"),Xs=r("We\u2019ve prepared a "),me=i("a"),Ks=r("template model repository"),Zs=r(" for this section, and if you want to run the code in this chapter you\u2019ll first need to copy the model to your account on the "),ge=i("a"),er=r("Hugging Face Hub"),tr=r(". To do so, first log in by running either the following in a Jupyter notebook:"),yo=h(),d(we.$$.fragment),$o=h(),ut=i("p"),or=r("or the following in your favorite terminal:"),vo=h(),d(_e.$$.fragment),Eo=h(),K=i("p"),sr=r("This will prompt you to enter your username and password, and will save a token under "),Pt=i("em"),rr=r("~/.cache/huggingface/"),ar=r(". Once you\u2019ve logged in, you can copy the template repository with the following function:"),qo=h(),d(be.$$.fragment),xo=h(),Z=i("p"),nr=r("Now when you call "),Dt=i("code"),ir=r("copy_repository_template()"),lr=r(", it will create a copy of the template repository under your account."),jo=h(),V=i("h2"),ee=i("a"),At=i("span"),d(ke.$$.fragment),ur=h(),It=i("span"),hr=r("Debugging the pipeline from \u{1F917} Transformers"),To=h(),ht=i("p"),pr=r("To kick off our journey into the wonderful world of debugging Transformer models, consider the following scenario: you\u2019re working with a colleague on a question answering project to help the customers of an e-commerce website find answers about consumer products. Your colleague shoots you a message like:"),Co=h(),pt=i("blockquote"),ye=i("p"),fr=r("G\u2019day! I just ran an experiment using the techniques in "),ft=i("a"),cr=r("Chapter 7"),dr=r(" of the Hugging Face course and got some great results on SQuAD! I think we can use this model as a starting point for our project. The model ID on the Hub is \u201Clewtun/distillbert-base-uncased-finetuned-squad-d5716d28\u201D. Feel free to test it out :)"),Po=h(),te=i("p"),mr=r("and the first thing you think of is to load the model using the "),Ot=i("code"),gr=r("pipeline"),wr=r(" from \u{1F917} Transformers:"),Do=h(),d($e.$$.fragment),Ao=h(),d(ve.$$.fragment),Io=h(),F=i("p"),_r=r("Oh no, something seems to have gone wrong! If you\u2019re new to programming, these kind of errors can seem a bit cryptic at first (what even is an "),St=i("code"),br=r("OSError"),kr=r("?!). The error displayed here is just the last part of a much larger error report called a "),zt=i("em"),yr=r("Python traceback"),$r=r(" (aka stack trace). For example, if you\u2019re running this code on Google Colab, you should see something like the following screenshot:"),Oo=h(),Ee=i("div"),qe=i("img"),So=h(),C=i("p"),vr=r("There\u2019s a lot of information contained in these reports, so let\u2019s walk through the key parts together. The first thing to note is that tracebacks should be read "),Ht=i("em"),Er=r("from bottom to top"),qr=r(". This might sound weird if you\u2019re used to reading English text from top to bottom, but it reflects the fact that the traceback shows the sequence of function calls that the "),Nt=i("code"),xr=r("pipeline"),jr=r(" makes when downloading the model and tokenizer. (Check out "),ct=i("a"),Tr=r("Chapter 2"),Cr=r(" for more details on how the "),Mt=i("code"),Pr=r("pipeline"),Dr=r(" works under the hood.)"),zo=h(),d(oe.$$.fragment),Ho=h(),L=i("p"),Ar=r("This means that the last line of the traceback indicates the last error message and gives the name of the exception that was raised. In this case, the exception type is "),Gt=i("code"),Ir=r("OSError"),Or=r(", which indicates a system-related error. If we read the accompanying error message, we can see that there seems to be a problem with the model\u2019s "),Ft=i("em"),Sr=r("config.json"),zr=r(" file, and we\u2019re given two suggestions to fix it:"),No=h(),d(xe.$$.fragment),Mo=h(),d(se.$$.fragment),Go=h(),dt=i("p"),Hr=r("The first suggestion is asking us to check whether the model ID is actually correct, so the first order of business is to copy the identifier and paste it into the Hub\u2019s search bar:"),Fo=h(),je=i("div"),Te=i("img"),Lo=h(),mt=i("p"),Nr=r("Hmm, it indeed looks like our colleague\u2019s model is not on the Hub\u2026 aha, but there\u2019s a typo in the name of the model! DistilBERT only has one \u201Cl\u201D in its name, so let\u2019s fix that and look for \u201Clewtun/distilbert-base-uncased-finetuned-squad-d5716d28\u201D instead:"),Wo=h(),Ce=i("div"),Pe=i("img"),Qo=h(),gt=i("p"),Mr=r("Okay, this got a hit. Now let\u2019s try to download the model again with the correct model ID:"),Yo=h(),d(De.$$.fragment),Ro=h(),d(Ae.$$.fragment),Bo=h(),W=i("p"),Gr=r("Argh, foiled again \u2014 welcome to the daily life of a machine learning engineer! Since we\u2019ve fixed the model ID, the problem must lie in the repository itself. A quick way to access the contents of a repository on the \u{1F917} Hub is via the "),Lt=i("code"),Fr=r("list_repo_files()"),Lr=r(" function of the "),Wt=i("code"),Wr=r("huggingface_hub"),Qr=r(" library:"),Vo=h(),d(Ie.$$.fragment),Jo=h(),d(Oe.$$.fragment),Uo=h(),x=i("p"),Yr=r("Interesting \u2014 there doesn\u2019t seem to be a "),Qt=i("em"),Rr=r("config.json"),Br=r(" file in the repository! No wonder our "),Yt=i("code"),Vr=r("pipeline"),Jr=r(" couldn\u2019t load the model; our colleague must have forgotten to push this file to the Hub after they fine-tuned it. In this case, the problem seems pretty straightforward to fix: we could ask them to add the file, or, since we can see from the model ID that the pretrained model used was "),Se=i("a"),Rt=i("code"),Ur=r("distilbert-base-uncased"),Xr=r(", we can download the config for this model and push it to our repo to see if that resolves the problem. Let\u2019s try that. Using the techniques we learned in "),wt=i("a"),Kr=r("Chapter 2"),Zr=r(", we can download the model\u2019s configuration with the "),Bt=i("code"),ea=r("AutoConfig"),ta=r(" class:"),Xo=h(),d(ze.$$.fragment),Ko=h(),d(re.$$.fragment),Zo=h(),ae=i("p"),oa=r("We can then push this to our model repository with the configuration\u2019s "),Vt=i("code"),sa=r("push_to_hub()"),ra=r(" function:"),es=h(),d(He.$$.fragment),ts=h(),ne=i("p"),aa=r("Now we can test if this worked by loading the model from the latest commit on the "),Jt=i("code"),na=r("main"),ia=r(" branch:"),os=h(),d(Ne.$$.fragment),ss=h(),d(Me.$$.fragment),rs=h(),_t=i("p"),la=r("Woohoo, it worked! Let\u2019s recap what you\u2019ve just learned:"),as=h(),I=i("ul"),Ge=i("li"),ua=r("The error messages in Python are known as "),Ut=i("em"),ha=r("tracebacks"),pa=r(" and are read from bottom to top. The last line of the error message usually contains the information you need to locate the source of the problem."),fa=h(),Xt=i("li"),ca=r("If the last line does not contain sufficient information, work your way up the traceback and see if you can identify where in the source code the error occurs."),da=h(),Kt=i("li"),ma=r("If none of the error messages can help you debug the problem, try searching online for a solution to a similar issue."),ga=h(),Fe=i("li"),wa=r("The "),Zt=i("code"),_a=r("huggingface_hub"),ba=r(`
// \u{1F917} Hub?
library provides a suite of tools that you can use to interact with and debug repositories on the Hub.`),ns=h(),bt=i("p"),ka=r("Now that you know how to debug a pipeline, let\u2019s take a look at a trickier example in the forward pass of the model itself."),is=h(),J=i("h2"),ie=i("a"),eo=i("span"),d(Le.$$.fragment),ya=h(),to=i("span"),$a=r("Debugging the forward pass of your model"),ls=h(),Q=i("p"),va=r("Although the "),oo=i("code"),Ea=r("pipeline"),qa=r(" is great for most applications where you need to quickly generate predictions, sometimes you\u2019ll need to access the model\u2019s logits (say, if you have some custom post-processing that you\u2019d like to apply). To see what can go wrong in this case, let\u2019s first grab the model and tokenizer from our "),so=i("code"),xa=r("pipeline"),ja=r(":"),us=h(),d(We.$$.fragment),hs=h(),kt=i("p"),Ta=r("Next we need a question, so let\u2019s see if our favorite frameworks are supported:"),ps=h(),d(Qe.$$.fragment),fs=h(),le=i("p"),Ca=r("As we saw in "),yt=i("a"),Pa=r("Chapter 7"),Da=r(", the usual steps we need to take are tokenizing the inputs, extracting the logits of the start and end tokens, and then decoding the answer span:"),cs=h(),d(Ye.$$.fragment),ds=h(),d(Re.$$.fragment),ms=h(),$t=i("p"),Aa=r("Oh dear, it looks like we have a bug in our code! But we\u2019re not afraid of a little debugging. You can use the Python debugger in a notebook:"),gs=h(),d(Be.$$.fragment),ws=h(),vt=i("p"),Ia=r("or in a terminal:"),_s=h(),d(Ve.$$.fragment),bs=h(),P=i("p"),Oa=r("Here, reading the error message tells us that "),ro=i("code"),Sa=r("'list' object has no attribute 'size'"),za=r(", and we can see a "),ao=i("code"),Ha=r("-->"),Na=r(" arrow pointing to the line where the problem was raised in "),no=i("code"),Ma=r("model(**inputs)"),Ga=r(".You can debug this interactively using the Python debugger, but for now we\u2019ll simply print out a slice of "),io=i("code"),Fa=r("inputs"),La=r(" to see what we have:"),ks=h(),d(Je.$$.fragment),ys=h(),d(Ue.$$.fragment),$s=h(),ue=i("p"),Wa=r("This certainly looks like an ordinary Python "),lo=i("code"),Qa=r("list"),Ya=r(", but let\u2019s double-check the type:"),vs=h(),d(Xe.$$.fragment),Es=h(),d(Ke.$$.fragment),qs=h(),j=i("p"),Ra=r("Yep, that\u2019s a Python "),uo=i("code"),Ba=r("list"),Va=r(" for sure. So what went wrong? Recall from "),Et=i("a"),Ja=r("Chapter 2"),Ua=r(" that the "),ho=i("code"),Xa=r("AutoModelForXxx"),Ka=r(" classes in \u{1F917} Transformers operate on "),po=i("em"),Za=r("tensors"),en=r(" (either in PyTorch or TensorFlow), and a common operation is to extract the dimensions of a tensor using "),fo=i("code"),tn=r("Tensor.size()"),on=r(" in, say, PyTorch. Let\u2019s take another look at the traceback, to see which line triggered the exception:"),xs=h(),d(Ze.$$.fragment),js=h(),O=i("p"),sn=r("It looks like our code tried to call "),co=i("code"),rn=r("input_ids.size()"),an=r(", but this clearly won\u2019t work for a Python "),mo=i("code"),nn=r("list"),ln=r(", which is just a container. How can we solve this problem? Searching for the error message on Stack Overflow gives quite a few relevant "),et=i("a"),un=r("hits"),hn=r(". Clicking on the first one displays a similar question to ours, with the answer shown in the screenshot below:"),Ts=h(),tt=i("div"),ot=i("img"),Cs=h(),he=i("p"),pn=r("The answer recommends that we add "),go=i("code"),fn=r("return_tensors='pt'"),cn=r(" to the tokenizer, so let\u2019s see if that works for us:"),Ps=h(),d(st.$$.fragment),Ds=h(),d(rt.$$.fragment),As=h(),pe=i("p"),dn=r("Nice, it worked! This is a great example of how useful Stack Overflow can be: by identifying a similar problem, we were able to benefit from the experience of others in the community. However, a search like this won\u2019t always yield a relevant answer, so what can you do in such cases? Fortunately, there is a welcoming community of developers on the "),at=i("a"),mn=r("Hugging Face forums"),gn=r(" that can help you out! In the next section, we\u2019ll take a look at how you can craft good forum questions that are likely to get answered."),this.h()},l(e){const s=Li('[data-svelte="svelte-1phssyn"]',document.head);c=l(s,"META",{name:!0,content:!0}),s.forEach(t),q=p(e),k=l(e,"H1",{class:!0});var nt=u(k);$=l(nt,"A",{id:!0,class:!0,href:!0});var wo=u($);D=l(wo,"SPAN",{});var _o=u(D);m(v.$$.fragment,_o),_o.forEach(t),wo.forEach(t),T=p(nt),A=l(nt,"SPAN",{});var En=u(A);H=a(En,"What to do when you get an error"),En.forEach(t),nt.forEach(t),X=p(e),m(N.$$.fragment,e),M=p(e),E=l(e,"P",{});var Os=u(E);it=a(Os,"In this section we\u2019ll look at some common errors that can occur when you\u2019re trying to generate predictions from your freshly tuned Transformer model. This will prepare you for "),B=l(Os,"A",{href:!0});var qn=u(B);lt=a(qn,"section 4"),qn.forEach(t),Us=a(Os,", where we\u2019ll explore how to debug the training phase itself."),Os.forEach(t),bo=p(e),m(de.$$.fragment,e),ko=p(e),G=l(e,"P",{});var qt=u(G);Xs=a(qt,"We\u2019ve prepared a "),me=l(qt,"A",{href:!0,rel:!0});var xn=u(me);Ks=a(xn,"template model repository"),xn.forEach(t),Zs=a(qt," for this section, and if you want to run the code in this chapter you\u2019ll first need to copy the model to your account on the "),ge=l(qt,"A",{href:!0,rel:!0});var jn=u(ge);er=a(jn,"Hugging Face Hub"),jn.forEach(t),tr=a(qt,". To do so, first log in by running either the following in a Jupyter notebook:"),qt.forEach(t),yo=p(e),m(we.$$.fragment,e),$o=p(e),ut=l(e,"P",{});var Tn=u(ut);or=a(Tn,"or the following in your favorite terminal:"),Tn.forEach(t),vo=p(e),m(_e.$$.fragment,e),Eo=p(e),K=l(e,"P",{});var Ss=u(K);sr=a(Ss,"This will prompt you to enter your username and password, and will save a token under "),Pt=l(Ss,"EM",{});var Cn=u(Pt);rr=a(Cn,"~/.cache/huggingface/"),Cn.forEach(t),ar=a(Ss,". Once you\u2019ve logged in, you can copy the template repository with the following function:"),Ss.forEach(t),qo=p(e),m(be.$$.fragment,e),xo=p(e),Z=l(e,"P",{});var zs=u(Z);nr=a(zs,"Now when you call "),Dt=l(zs,"CODE",{});var Pn=u(Dt);ir=a(Pn,"copy_repository_template()"),Pn.forEach(t),lr=a(zs,", it will create a copy of the template repository under your account."),zs.forEach(t),jo=p(e),V=l(e,"H2",{class:!0});var Hs=u(V);ee=l(Hs,"A",{id:!0,class:!0,href:!0});var Dn=u(ee);At=l(Dn,"SPAN",{});var An=u(At);m(ke.$$.fragment,An),An.forEach(t),Dn.forEach(t),ur=p(Hs),It=l(Hs,"SPAN",{});var In=u(It);hr=a(In,"Debugging the pipeline from \u{1F917} Transformers"),In.forEach(t),Hs.forEach(t),To=p(e),ht=l(e,"P",{});var On=u(ht);pr=a(On,"To kick off our journey into the wonderful world of debugging Transformer models, consider the following scenario: you\u2019re working with a colleague on a question answering project to help the customers of an e-commerce website find answers about consumer products. Your colleague shoots you a message like:"),On.forEach(t),Co=p(e),pt=l(e,"BLOCKQUOTE",{});var Sn=u(pt);ye=l(Sn,"P",{});var Ns=u(ye);fr=a(Ns,"G\u2019day! I just ran an experiment using the techniques in "),ft=l(Ns,"A",{href:!0});var zn=u(ft);cr=a(zn,"Chapter 7"),zn.forEach(t),dr=a(Ns," of the Hugging Face course and got some great results on SQuAD! I think we can use this model as a starting point for our project. The model ID on the Hub is \u201Clewtun/distillbert-base-uncased-finetuned-squad-d5716d28\u201D. Feel free to test it out :)"),Ns.forEach(t),Sn.forEach(t),Po=p(e),te=l(e,"P",{});var Ms=u(te);mr=a(Ms,"and the first thing you think of is to load the model using the "),Ot=l(Ms,"CODE",{});var Hn=u(Ot);gr=a(Hn,"pipeline"),Hn.forEach(t),wr=a(Ms," from \u{1F917} Transformers:"),Ms.forEach(t),Do=p(e),m($e.$$.fragment,e),Ao=p(e),m(ve.$$.fragment,e),Io=p(e),F=l(e,"P",{});var xt=u(F);_r=a(xt,"Oh no, something seems to have gone wrong! If you\u2019re new to programming, these kind of errors can seem a bit cryptic at first (what even is an "),St=l(xt,"CODE",{});var Nn=u(St);br=a(Nn,"OSError"),Nn.forEach(t),kr=a(xt,"?!). The error displayed here is just the last part of a much larger error report called a "),zt=l(xt,"EM",{});var Mn=u(zt);yr=a(Mn,"Python traceback"),Mn.forEach(t),$r=a(xt," (aka stack trace). For example, if you\u2019re running this code on Google Colab, you should see something like the following screenshot:"),xt.forEach(t),Oo=p(e),Ee=l(e,"DIV",{class:!0});var Gn=u(Ee);qe=l(Gn,"IMG",{src:!0,alt:!0,width:!0}),Gn.forEach(t),So=p(e),C=l(e,"P",{});var Y=u(C);vr=a(Y,"There\u2019s a lot of information contained in these reports, so let\u2019s walk through the key parts together. The first thing to note is that tracebacks should be read "),Ht=l(Y,"EM",{});var Fn=u(Ht);Er=a(Fn,"from bottom to top"),Fn.forEach(t),qr=a(Y,". This might sound weird if you\u2019re used to reading English text from top to bottom, but it reflects the fact that the traceback shows the sequence of function calls that the "),Nt=l(Y,"CODE",{});var Ln=u(Nt);xr=a(Ln,"pipeline"),Ln.forEach(t),jr=a(Y," makes when downloading the model and tokenizer. (Check out "),ct=l(Y,"A",{href:!0});var Wn=u(ct);Tr=a(Wn,"Chapter 2"),Wn.forEach(t),Cr=a(Y," for more details on how the "),Mt=l(Y,"CODE",{});var Qn=u(Mt);Pr=a(Qn,"pipeline"),Qn.forEach(t),Dr=a(Y," works under the hood.)"),Y.forEach(t),zo=p(e),m(oe.$$.fragment,e),Ho=p(e),L=l(e,"P",{});var jt=u(L);Ar=a(jt,"This means that the last line of the traceback indicates the last error message and gives the name of the exception that was raised. In this case, the exception type is "),Gt=l(jt,"CODE",{});var Yn=u(Gt);Ir=a(Yn,"OSError"),Yn.forEach(t),Or=a(jt,", which indicates a system-related error. If we read the accompanying error message, we can see that there seems to be a problem with the model\u2019s "),Ft=l(jt,"EM",{});var Rn=u(Ft);Sr=a(Rn,"config.json"),Rn.forEach(t),zr=a(jt," file, and we\u2019re given two suggestions to fix it:"),jt.forEach(t),No=p(e),m(xe.$$.fragment,e),Mo=p(e),m(se.$$.fragment,e),Go=p(e),dt=l(e,"P",{});var Bn=u(dt);Hr=a(Bn,"The first suggestion is asking us to check whether the model ID is actually correct, so the first order of business is to copy the identifier and paste it into the Hub\u2019s search bar:"),Bn.forEach(t),Fo=p(e),je=l(e,"DIV",{class:!0});var Vn=u(je);Te=l(Vn,"IMG",{src:!0,alt:!0,width:!0}),Vn.forEach(t),Lo=p(e),mt=l(e,"P",{});var Jn=u(mt);Nr=a(Jn,"Hmm, it indeed looks like our colleague\u2019s model is not on the Hub\u2026 aha, but there\u2019s a typo in the name of the model! DistilBERT only has one \u201Cl\u201D in its name, so let\u2019s fix that and look for \u201Clewtun/distilbert-base-uncased-finetuned-squad-d5716d28\u201D instead:"),Jn.forEach(t),Wo=p(e),Ce=l(e,"DIV",{class:!0});var Un=u(Ce);Pe=l(Un,"IMG",{src:!0,alt:!0,width:!0}),Un.forEach(t),Qo=p(e),gt=l(e,"P",{});var Xn=u(gt);Mr=a(Xn,"Okay, this got a hit. Now let\u2019s try to download the model again with the correct model ID:"),Xn.forEach(t),Yo=p(e),m(De.$$.fragment,e),Ro=p(e),m(Ae.$$.fragment,e),Bo=p(e),W=l(e,"P",{});var Tt=u(W);Gr=a(Tt,"Argh, foiled again \u2014 welcome to the daily life of a machine learning engineer! Since we\u2019ve fixed the model ID, the problem must lie in the repository itself. A quick way to access the contents of a repository on the \u{1F917} Hub is via the "),Lt=l(Tt,"CODE",{});var Kn=u(Lt);Fr=a(Kn,"list_repo_files()"),Kn.forEach(t),Lr=a(Tt," function of the "),Wt=l(Tt,"CODE",{});var Zn=u(Wt);Wr=a(Zn,"huggingface_hub"),Zn.forEach(t),Qr=a(Tt," library:"),Tt.forEach(t),Vo=p(e),m(Ie.$$.fragment,e),Jo=p(e),m(Oe.$$.fragment,e),Uo=p(e),x=l(e,"P",{});var S=u(x);Yr=a(S,"Interesting \u2014 there doesn\u2019t seem to be a "),Qt=l(S,"EM",{});var ei=u(Qt);Rr=a(ei,"config.json"),ei.forEach(t),Br=a(S," file in the repository! No wonder our "),Yt=l(S,"CODE",{});var ti=u(Yt);Vr=a(ti,"pipeline"),ti.forEach(t),Jr=a(S," couldn\u2019t load the model; our colleague must have forgotten to push this file to the Hub after they fine-tuned it. In this case, the problem seems pretty straightforward to fix: we could ask them to add the file, or, since we can see from the model ID that the pretrained model used was "),Se=l(S,"A",{href:!0,rel:!0});var oi=u(Se);Rt=l(oi,"CODE",{});var si=u(Rt);Ur=a(si,"distilbert-base-uncased"),si.forEach(t),oi.forEach(t),Xr=a(S,", we can download the config for this model and push it to our repo to see if that resolves the problem. Let\u2019s try that. Using the techniques we learned in "),wt=l(S,"A",{href:!0});var ri=u(wt);Kr=a(ri,"Chapter 2"),ri.forEach(t),Zr=a(S,", we can download the model\u2019s configuration with the "),Bt=l(S,"CODE",{});var ai=u(Bt);ea=a(ai,"AutoConfig"),ai.forEach(t),ta=a(S," class:"),S.forEach(t),Xo=p(e),m(ze.$$.fragment,e),Ko=p(e),m(re.$$.fragment,e),Zo=p(e),ae=l(e,"P",{});var Gs=u(ae);oa=a(Gs,"We can then push this to our model repository with the configuration\u2019s "),Vt=l(Gs,"CODE",{});var ni=u(Vt);sa=a(ni,"push_to_hub()"),ni.forEach(t),ra=a(Gs," function:"),Gs.forEach(t),es=p(e),m(He.$$.fragment,e),ts=p(e),ne=l(e,"P",{});var Fs=u(ne);aa=a(Fs,"Now we can test if this worked by loading the model from the latest commit on the "),Jt=l(Fs,"CODE",{});var ii=u(Jt);na=a(ii,"main"),ii.forEach(t),ia=a(Fs," branch:"),Fs.forEach(t),os=p(e),m(Ne.$$.fragment,e),ss=p(e),m(Me.$$.fragment,e),rs=p(e),_t=l(e,"P",{});var li=u(_t);la=a(li,"Woohoo, it worked! Let\u2019s recap what you\u2019ve just learned:"),li.forEach(t),as=p(e),I=l(e,"UL",{});var fe=u(I);Ge=l(fe,"LI",{});var Ls=u(Ge);ua=a(Ls,"The error messages in Python are known as "),Ut=l(Ls,"EM",{});var ui=u(Ut);ha=a(ui,"tracebacks"),ui.forEach(t),pa=a(Ls," and are read from bottom to top. The last line of the error message usually contains the information you need to locate the source of the problem."),Ls.forEach(t),fa=p(fe),Xt=l(fe,"LI",{});var hi=u(Xt);ca=a(hi,"If the last line does not contain sufficient information, work your way up the traceback and see if you can identify where in the source code the error occurs."),hi.forEach(t),da=p(fe),Kt=l(fe,"LI",{});var pi=u(Kt);ma=a(pi,"If none of the error messages can help you debug the problem, try searching online for a solution to a similar issue."),pi.forEach(t),ga=p(fe),Fe=l(fe,"LI",{});var Ws=u(Fe);wa=a(Ws,"The "),Zt=l(Ws,"CODE",{});var fi=u(Zt);_a=a(fi,"huggingface_hub"),fi.forEach(t),ba=a(Ws,`
// \u{1F917} Hub?
library provides a suite of tools that you can use to interact with and debug repositories on the Hub.`),Ws.forEach(t),fe.forEach(t),ns=p(e),bt=l(e,"P",{});var ci=u(bt);ka=a(ci,"Now that you know how to debug a pipeline, let\u2019s take a look at a trickier example in the forward pass of the model itself."),ci.forEach(t),is=p(e),J=l(e,"H2",{class:!0});var Qs=u(J);ie=l(Qs,"A",{id:!0,class:!0,href:!0});var di=u(ie);eo=l(di,"SPAN",{});var mi=u(eo);m(Le.$$.fragment,mi),mi.forEach(t),di.forEach(t),ya=p(Qs),to=l(Qs,"SPAN",{});var gi=u(to);$a=a(gi,"Debugging the forward pass of your model"),gi.forEach(t),Qs.forEach(t),ls=p(e),Q=l(e,"P",{});var Ct=u(Q);va=a(Ct,"Although the "),oo=l(Ct,"CODE",{});var wi=u(oo);Ea=a(wi,"pipeline"),wi.forEach(t),qa=a(Ct," is great for most applications where you need to quickly generate predictions, sometimes you\u2019ll need to access the model\u2019s logits (say, if you have some custom post-processing that you\u2019d like to apply). To see what can go wrong in this case, let\u2019s first grab the model and tokenizer from our "),so=l(Ct,"CODE",{});var _i=u(so);xa=a(_i,"pipeline"),_i.forEach(t),ja=a(Ct,":"),Ct.forEach(t),us=p(e),m(We.$$.fragment,e),hs=p(e),kt=l(e,"P",{});var bi=u(kt);Ta=a(bi,"Next we need a question, so let\u2019s see if our favorite frameworks are supported:"),bi.forEach(t),ps=p(e),m(Qe.$$.fragment,e),fs=p(e),le=l(e,"P",{});var Ys=u(le);Ca=a(Ys,"As we saw in "),yt=l(Ys,"A",{href:!0});var ki=u(yt);Pa=a(ki,"Chapter 7"),ki.forEach(t),Da=a(Ys,", the usual steps we need to take are tokenizing the inputs, extracting the logits of the start and end tokens, and then decoding the answer span:"),Ys.forEach(t),cs=p(e),m(Ye.$$.fragment,e),ds=p(e),m(Re.$$.fragment,e),ms=p(e),$t=l(e,"P",{});var yi=u($t);Aa=a(yi,"Oh dear, it looks like we have a bug in our code! But we\u2019re not afraid of a little debugging. You can use the Python debugger in a notebook:"),yi.forEach(t),gs=p(e),m(Be.$$.fragment,e),ws=p(e),vt=l(e,"P",{});var $i=u(vt);Ia=a($i,"or in a terminal:"),$i.forEach(t),_s=p(e),m(Ve.$$.fragment,e),bs=p(e),P=l(e,"P",{});var R=u(P);Oa=a(R,"Here, reading the error message tells us that "),ro=l(R,"CODE",{});var vi=u(ro);Sa=a(vi,"'list' object has no attribute 'size'"),vi.forEach(t),za=a(R,", and we can see a "),ao=l(R,"CODE",{});var Ei=u(ao);Ha=a(Ei,"-->"),Ei.forEach(t),Na=a(R," arrow pointing to the line where the problem was raised in "),no=l(R,"CODE",{});var qi=u(no);Ma=a(qi,"model(**inputs)"),qi.forEach(t),Ga=a(R,".You can debug this interactively using the Python debugger, but for now we\u2019ll simply print out a slice of "),io=l(R,"CODE",{});var xi=u(io);Fa=a(xi,"inputs"),xi.forEach(t),La=a(R," to see what we have:"),R.forEach(t),ks=p(e),m(Je.$$.fragment,e),ys=p(e),m(Ue.$$.fragment,e),$s=p(e),ue=l(e,"P",{});var Rs=u(ue);Wa=a(Rs,"This certainly looks like an ordinary Python "),lo=l(Rs,"CODE",{});var ji=u(lo);Qa=a(ji,"list"),ji.forEach(t),Ya=a(Rs,", but let\u2019s double-check the type:"),Rs.forEach(t),vs=p(e),m(Xe.$$.fragment,e),Es=p(e),m(Ke.$$.fragment,e),qs=p(e),j=l(e,"P",{});var z=u(j);Ra=a(z,"Yep, that\u2019s a Python "),uo=l(z,"CODE",{});var Ti=u(uo);Ba=a(Ti,"list"),Ti.forEach(t),Va=a(z," for sure. So what went wrong? Recall from "),Et=l(z,"A",{href:!0});var Ci=u(Et);Ja=a(Ci,"Chapter 2"),Ci.forEach(t),Ua=a(z," that the "),ho=l(z,"CODE",{});var Pi=u(ho);Xa=a(Pi,"AutoModelForXxx"),Pi.forEach(t),Ka=a(z," classes in \u{1F917} Transformers operate on "),po=l(z,"EM",{});var Di=u(po);Za=a(Di,"tensors"),Di.forEach(t),en=a(z," (either in PyTorch or TensorFlow), and a common operation is to extract the dimensions of a tensor using "),fo=l(z,"CODE",{});var Ai=u(fo);tn=a(Ai,"Tensor.size()"),Ai.forEach(t),on=a(z," in, say, PyTorch. Let\u2019s take another look at the traceback, to see which line triggered the exception:"),z.forEach(t),xs=p(e),m(Ze.$$.fragment,e),js=p(e),O=l(e,"P",{});var ce=u(O);sn=a(ce,"It looks like our code tried to call "),co=l(ce,"CODE",{});var Ii=u(co);rn=a(Ii,"input_ids.size()"),Ii.forEach(t),an=a(ce,", but this clearly won\u2019t work for a Python "),mo=l(ce,"CODE",{});var Oi=u(mo);nn=a(Oi,"list"),Oi.forEach(t),ln=a(ce,", which is just a container. How can we solve this problem? Searching for the error message on Stack Overflow gives quite a few relevant "),et=l(ce,"A",{href:!0,rel:!0});var Si=u(et);un=a(Si,"hits"),Si.forEach(t),hn=a(ce,". Clicking on the first one displays a similar question to ours, with the answer shown in the screenshot below:"),ce.forEach(t),Ts=p(e),tt=l(e,"DIV",{class:!0});var zi=u(tt);ot=l(zi,"IMG",{src:!0,alt:!0,width:!0}),zi.forEach(t),Cs=p(e),he=l(e,"P",{});var Bs=u(he);pn=a(Bs,"The answer recommends that we add "),go=l(Bs,"CODE",{});var Hi=u(go);fn=a(Hi,"return_tensors='pt'"),Hi.forEach(t),cn=a(Bs," to the tokenizer, so let\u2019s see if that works for us:"),Bs.forEach(t),Ps=p(e),m(st.$$.fragment,e),Ds=p(e),m(rt.$$.fragment,e),As=p(e),pe=l(e,"P",{});var Vs=u(pe);dn=a(Vs,"Nice, it worked! This is a great example of how useful Stack Overflow can be: by identifying a similar problem, we were able to benefit from the experience of others in the community. However, a search like this won\u2019t always yield a relevant answer, so what can you do in such cases? Fortunately, there is a welcoming community of developers on the "),at=l(Vs,"A",{href:!0,rel:!0});var Ni=u(at);mn=a(Ni,"Hugging Face forums"),Ni.forEach(t),gn=a(Vs," that can help you out! In the next section, we\u2019ll take a look at how you can craft good forum questions that are likely to get answered."),Vs.forEach(t),this.h()},h(){f(c,"name","hf:doc:metadata"),f(c,"content",JSON.stringify(Ji)),f($,"id","what-to-do-when-you-get-an-error"),f($,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),f($,"href","#what-to-do-when-you-get-an-error"),f(k,"class","relative group"),f(B,"href","/course/chapter8/section4"),f(me,"href","https://huggingface.co/lewtun/distilbert-base-uncased-finetuned-squad-d5716d28"),f(me,"rel","nofollow"),f(ge,"href","https://huggingface.co"),f(ge,"rel","nofollow"),f(ee,"id","debugging-the-pipeline-from-transformers"),f(ee,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),f(ee,"href","#debugging-the-pipeline-from-transformers"),f(V,"class","relative group"),f(ft,"href","/course/chapter7/7"),Js(qe.src,kn="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter8/traceback.png")||f(qe,"src",kn),f(qe,"alt","A Python traceback."),f(qe,"width","100%"),f(Ee,"class","flex justify-center"),f(ct,"href","/course/chapter2"),Js(Te.src,yn="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter8/wrong-model-id.png")||f(Te,"src",yn),f(Te,"alt","The wrong model name."),f(Te,"width","100%"),f(je,"class","flex justify-center"),Js(Pe.src,$n="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter8/true-model-id.png")||f(Pe,"src",$n),f(Pe,"alt","The right model name."),f(Pe,"width","100%"),f(Ce,"class","flex justify-center"),f(Se,"href","https://huggingface.co/distilbert-base-uncased"),f(Se,"rel","nofollow"),f(wt,"href","/course/chapter2"),f(ie,"id","debugging-the-forward-pass-of-your-model"),f(ie,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),f(ie,"href","#debugging-the-forward-pass-of-your-model"),f(J,"class","relative group"),f(yt,"href","/course/chapter7"),f(Et,"href","/course/chapter2"),f(et,"href","https://stackoverflow.com/search?q=AttributeError%3A+%27list%27+object+has+no+attribute+%27size%27&s=c15ec54c-63cb-481d-a749-408920073e8f"),f(et,"rel","nofollow"),Js(ot.src,vn="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter8/stack-overflow.png")||f(ot,"src",vn),f(ot,"alt","An answer from Stack Overflow."),f(ot,"width","100%"),f(tt,"class","flex justify-center"),f(at,"href","https://discuss.huggingface.co/"),f(at,"rel","nofollow")},m(e,s){o(document.head,c),n(e,q,s),n(e,k,s),o(k,$),o($,D),g(v,D,null),o(k,T),o(k,A),o(A,H),n(e,X,s),g(N,e,s),n(e,M,s),n(e,E,s),o(E,it),o(E,B),o(B,lt),o(E,Us),n(e,bo,s),g(de,e,s),n(e,ko,s),n(e,G,s),o(G,Xs),o(G,me),o(me,Ks),o(G,Zs),o(G,ge),o(ge,er),o(G,tr),n(e,yo,s),g(we,e,s),n(e,$o,s),n(e,ut,s),o(ut,or),n(e,vo,s),g(_e,e,s),n(e,Eo,s),n(e,K,s),o(K,sr),o(K,Pt),o(Pt,rr),o(K,ar),n(e,qo,s),g(be,e,s),n(e,xo,s),n(e,Z,s),o(Z,nr),o(Z,Dt),o(Dt,ir),o(Z,lr),n(e,jo,s),n(e,V,s),o(V,ee),o(ee,At),g(ke,At,null),o(V,ur),o(V,It),o(It,hr),n(e,To,s),n(e,ht,s),o(ht,pr),n(e,Co,s),n(e,pt,s),o(pt,ye),o(ye,fr),o(ye,ft),o(ft,cr),o(ye,dr),n(e,Po,s),n(e,te,s),o(te,mr),o(te,Ot),o(Ot,gr),o(te,wr),n(e,Do,s),g($e,e,s),n(e,Ao,s),g(ve,e,s),n(e,Io,s),n(e,F,s),o(F,_r),o(F,St),o(St,br),o(F,kr),o(F,zt),o(zt,yr),o(F,$r),n(e,Oo,s),n(e,Ee,s),o(Ee,qe),n(e,So,s),n(e,C,s),o(C,vr),o(C,Ht),o(Ht,Er),o(C,qr),o(C,Nt),o(Nt,xr),o(C,jr),o(C,ct),o(ct,Tr),o(C,Cr),o(C,Mt),o(Mt,Pr),o(C,Dr),n(e,zo,s),g(oe,e,s),n(e,Ho,s),n(e,L,s),o(L,Ar),o(L,Gt),o(Gt,Ir),o(L,Or),o(L,Ft),o(Ft,Sr),o(L,zr),n(e,No,s),g(xe,e,s),n(e,Mo,s),g(se,e,s),n(e,Go,s),n(e,dt,s),o(dt,Hr),n(e,Fo,s),n(e,je,s),o(je,Te),n(e,Lo,s),n(e,mt,s),o(mt,Nr),n(e,Wo,s),n(e,Ce,s),o(Ce,Pe),n(e,Qo,s),n(e,gt,s),o(gt,Mr),n(e,Yo,s),g(De,e,s),n(e,Ro,s),g(Ae,e,s),n(e,Bo,s),n(e,W,s),o(W,Gr),o(W,Lt),o(Lt,Fr),o(W,Lr),o(W,Wt),o(Wt,Wr),o(W,Qr),n(e,Vo,s),g(Ie,e,s),n(e,Jo,s),g(Oe,e,s),n(e,Uo,s),n(e,x,s),o(x,Yr),o(x,Qt),o(Qt,Rr),o(x,Br),o(x,Yt),o(Yt,Vr),o(x,Jr),o(x,Se),o(Se,Rt),o(Rt,Ur),o(x,Xr),o(x,wt),o(wt,Kr),o(x,Zr),o(x,Bt),o(Bt,ea),o(x,ta),n(e,Xo,s),g(ze,e,s),n(e,Ko,s),g(re,e,s),n(e,Zo,s),n(e,ae,s),o(ae,oa),o(ae,Vt),o(Vt,sa),o(ae,ra),n(e,es,s),g(He,e,s),n(e,ts,s),n(e,ne,s),o(ne,aa),o(ne,Jt),o(Jt,na),o(ne,ia),n(e,os,s),g(Ne,e,s),n(e,ss,s),g(Me,e,s),n(e,rs,s),n(e,_t,s),o(_t,la),n(e,as,s),n(e,I,s),o(I,Ge),o(Ge,ua),o(Ge,Ut),o(Ut,ha),o(Ge,pa),o(I,fa),o(I,Xt),o(Xt,ca),o(I,da),o(I,Kt),o(Kt,ma),o(I,ga),o(I,Fe),o(Fe,wa),o(Fe,Zt),o(Zt,_a),o(Fe,ba),n(e,ns,s),n(e,bt,s),o(bt,ka),n(e,is,s),n(e,J,s),o(J,ie),o(ie,eo),g(Le,eo,null),o(J,ya),o(J,to),o(to,$a),n(e,ls,s),n(e,Q,s),o(Q,va),o(Q,oo),o(oo,Ea),o(Q,qa),o(Q,so),o(so,xa),o(Q,ja),n(e,us,s),g(We,e,s),n(e,hs,s),n(e,kt,s),o(kt,Ta),n(e,ps,s),g(Qe,e,s),n(e,fs,s),n(e,le,s),o(le,Ca),o(le,yt),o(yt,Pa),o(le,Da),n(e,cs,s),g(Ye,e,s),n(e,ds,s),g(Re,e,s),n(e,ms,s),n(e,$t,s),o($t,Aa),n(e,gs,s),g(Be,e,s),n(e,ws,s),n(e,vt,s),o(vt,Ia),n(e,_s,s),g(Ve,e,s),n(e,bs,s),n(e,P,s),o(P,Oa),o(P,ro),o(ro,Sa),o(P,za),o(P,ao),o(ao,Ha),o(P,Na),o(P,no),o(no,Ma),o(P,Ga),o(P,io),o(io,Fa),o(P,La),n(e,ks,s),g(Je,e,s),n(e,ys,s),g(Ue,e,s),n(e,$s,s),n(e,ue,s),o(ue,Wa),o(ue,lo),o(lo,Qa),o(ue,Ya),n(e,vs,s),g(Xe,e,s),n(e,Es,s),g(Ke,e,s),n(e,qs,s),n(e,j,s),o(j,Ra),o(j,uo),o(uo,Ba),o(j,Va),o(j,Et),o(Et,Ja),o(j,Ua),o(j,ho),o(ho,Xa),o(j,Ka),o(j,po),o(po,Za),o(j,en),o(j,fo),o(fo,tn),o(j,on),n(e,xs,s),g(Ze,e,s),n(e,js,s),n(e,O,s),o(O,sn),o(O,co),o(co,rn),o(O,an),o(O,mo),o(mo,nn),o(O,ln),o(O,et),o(et,un),o(O,hn),n(e,Ts,s),n(e,tt,s),o(tt,ot),n(e,Cs,s),n(e,he,s),o(he,pn),o(he,go),o(go,fn),o(he,cn),n(e,Ps,s),g(st,e,s),n(e,Ds,s),g(rt,e,s),n(e,As,s),n(e,pe,s),o(pe,dn),o(pe,at),o(at,mn),o(pe,gn),Is=!0},p(e,[s]){const nt={};s&2&&(nt.$$scope={dirty:s,ctx:e}),oe.$set(nt);const wo={};s&2&&(wo.$$scope={dirty:s,ctx:e}),se.$set(wo);const _o={};s&2&&(_o.$$scope={dirty:s,ctx:e}),re.$set(_o)},i(e){Is||(w(v.$$.fragment,e),w(N.$$.fragment,e),w(de.$$.fragment,e),w(we.$$.fragment,e),w(_e.$$.fragment,e),w(be.$$.fragment,e),w(ke.$$.fragment,e),w($e.$$.fragment,e),w(ve.$$.fragment,e),w(oe.$$.fragment,e),w(xe.$$.fragment,e),w(se.$$.fragment,e),w(De.$$.fragment,e),w(Ae.$$.fragment,e),w(Ie.$$.fragment,e),w(Oe.$$.fragment,e),w(ze.$$.fragment,e),w(re.$$.fragment,e),w(He.$$.fragment,e),w(Ne.$$.fragment,e),w(Me.$$.fragment,e),w(Le.$$.fragment,e),w(We.$$.fragment,e),w(Qe.$$.fragment,e),w(Ye.$$.fragment,e),w(Re.$$.fragment,e),w(Be.$$.fragment,e),w(Ve.$$.fragment,e),w(Je.$$.fragment,e),w(Ue.$$.fragment,e),w(Xe.$$.fragment,e),w(Ke.$$.fragment,e),w(Ze.$$.fragment,e),w(st.$$.fragment,e),w(rt.$$.fragment,e),Is=!0)},o(e){_(v.$$.fragment,e),_(N.$$.fragment,e),_(de.$$.fragment,e),_(we.$$.fragment,e),_(_e.$$.fragment,e),_(be.$$.fragment,e),_(ke.$$.fragment,e),_($e.$$.fragment,e),_(ve.$$.fragment,e),_(oe.$$.fragment,e),_(xe.$$.fragment,e),_(se.$$.fragment,e),_(De.$$.fragment,e),_(Ae.$$.fragment,e),_(Ie.$$.fragment,e),_(Oe.$$.fragment,e),_(ze.$$.fragment,e),_(re.$$.fragment,e),_(He.$$.fragment,e),_(Ne.$$.fragment,e),_(Me.$$.fragment,e),_(Le.$$.fragment,e),_(We.$$.fragment,e),_(Qe.$$.fragment,e),_(Ye.$$.fragment,e),_(Re.$$.fragment,e),_(Be.$$.fragment,e),_(Ve.$$.fragment,e),_(Je.$$.fragment,e),_(Ue.$$.fragment,e),_(Xe.$$.fragment,e),_(Ke.$$.fragment,e),_(Ze.$$.fragment,e),_(st.$$.fragment,e),_(rt.$$.fragment,e),Is=!1},d(e){t(c),e&&t(q),e&&t(k),b(v),e&&t(X),b(N,e),e&&t(M),e&&t(E),e&&t(bo),b(de,e),e&&t(ko),e&&t(G),e&&t(yo),b(we,e),e&&t($o),e&&t(ut),e&&t(vo),b(_e,e),e&&t(Eo),e&&t(K),e&&t(qo),b(be,e),e&&t(xo),e&&t(Z),e&&t(jo),e&&t(V),b(ke),e&&t(To),e&&t(ht),e&&t(Co),e&&t(pt),e&&t(Po),e&&t(te),e&&t(Do),b($e,e),e&&t(Ao),b(ve,e),e&&t(Io),e&&t(F),e&&t(Oo),e&&t(Ee),e&&t(So),e&&t(C),e&&t(zo),b(oe,e),e&&t(Ho),e&&t(L),e&&t(No),b(xe,e),e&&t(Mo),b(se,e),e&&t(Go),e&&t(dt),e&&t(Fo),e&&t(je),e&&t(Lo),e&&t(mt),e&&t(Wo),e&&t(Ce),e&&t(Qo),e&&t(gt),e&&t(Yo),b(De,e),e&&t(Ro),b(Ae,e),e&&t(Bo),e&&t(W),e&&t(Vo),b(Ie,e),e&&t(Jo),b(Oe,e),e&&t(Uo),e&&t(x),e&&t(Xo),b(ze,e),e&&t(Ko),b(re,e),e&&t(Zo),e&&t(ae),e&&t(es),b(He,e),e&&t(ts),e&&t(ne),e&&t(os),b(Ne,e),e&&t(ss),b(Me,e),e&&t(rs),e&&t(_t),e&&t(as),e&&t(I),e&&t(ns),e&&t(bt),e&&t(is),e&&t(J),b(Le),e&&t(ls),e&&t(Q),e&&t(us),b(We,e),e&&t(hs),e&&t(kt),e&&t(ps),b(Qe,e),e&&t(fs),e&&t(le),e&&t(cs),b(Ye,e),e&&t(ds),b(Re,e),e&&t(ms),e&&t($t),e&&t(gs),b(Be,e),e&&t(ws),e&&t(vt),e&&t(_s),b(Ve,e),e&&t(bs),e&&t(P),e&&t(ks),b(Je,e),e&&t(ys),b(Ue,e),e&&t($s),e&&t(ue),e&&t(vs),b(Xe,e),e&&t(Es),b(Ke,e),e&&t(qs),e&&t(j),e&&t(xs),b(Ze,e),e&&t(js),e&&t(O),e&&t(Ts),e&&t(tt),e&&t(Cs),e&&t(he),e&&t(Ps),b(st,e),e&&t(Ds),b(rt,e),e&&t(As),e&&t(pe)}}}const Ji={local:"what-to-do-when-you-get-an-error",sections:[{local:"debugging-the-pipeline-from-transformers",title:"Debugging the pipeline from \u{1F917} Transformers"},{local:"debugging-the-forward-pass-of-your-model",title:"Debugging the forward pass of your model"}],title:"What to do when you get an error"};function Ui(U){return Wi(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class sl extends Mi{constructor(c){super();Gi(this,c,Ui,Vi,Fi,{})}}export{sl as default,Ji as metadata};
