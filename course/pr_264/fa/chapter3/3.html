<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;api-trainer&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ุชุนูู&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ุงุฑุฒุงุจ&quot;}],&quot;title&quot;:&quot;ฺฉูฺฉ ฺฉุฑุฏู ูุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ API `Trainer`&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/pages/chapter3/3.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_264/fa/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<div dir="rtl"><h1 class="relative group"><a id="api-trainer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#api-trainer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ฺฉูฺฉ ฺฉุฑุฏู ูุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ API <code>Trainer</code></span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/nvBXf7s7vTI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>ุชุฑูุณููุฑูุฑูุง ูุงฺฏูฺฏโููุณ ฺฉูุงุณ ุจู ูุงู <code>Trainer</code> ุฏุงุฑูุฏ ฺฉู ุจุฑุง ฺฉูฺฉ ุจู ฺฉูฺฉ ฺฉุฑุฏู ูุฑ ูุฏู ุงุฒ ูพุด ุชุนูู ุฏุฏูโุง ฺฉู ุฑู ุฏุงุฏู ุดูุง ุงุฑุงุฆู ูโุฏูุฏ ุจู ฺฉุงุฑ ูโุฑูุฏ. ุจู ูุญุถ ุงูฺฉู ููู ฺฉุงุฑูุง ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏู ุฏุฑ ุจุฎุด ุขุฎุฑ ุฑุง ุงูุฌุงู ุฏุงุฏุฏุ ููุท ฺูุฏ ูุฑุญูู ุจุงูโูุงูุฏู ุชุง ุชุนุฑู <code>Trainer</code> ุฏุงุฑุฏ. ุณุฎุช ุชุฑู ูุณูุชุ ุงุญุชูุงูุง ุขูุงุฏูโุณุงุฒ ูุญุท ุฌูุช ุงุฌุฑุงู <span dir="ltr"><code>Trainer.train()</code></span> ูโุจุงุดุฏุ ฺุฑุง ฺฉู ุงู ุชุงุจุน ุฑู CPU ุจุณุงุฑ ฺฉูุฏ ุงุฌุฑุง ูโุดูุฏ. ุงฺฏุฑ GPU ูุฏุงุฑุฏุ ูโุชูุงูุฏ ุงุฒ GPU ุง TPUูุง ูุฌุงู ุฑู <a href="https://colab.research.google.com/" rel="nofollow">ฺฏูฺฏู ฺฉูููุจ</a> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ููููู ฺฉุฏูุง ุฒุฑ ูุฑุถ ูโฺฉููุฏ ฺฉู ุดูุง ูุซุงูโูุง ุจุฎุด ูุจู ุฑุง ุงุฒ ูพุด ุงุฌุฑุง ฺฉุฑุฏูโุงุฏ. ุงู ฺฉ ุฎูุงุตู ฺฉูุชุงู ุงุณุช ุฌูุช ุงุฏุขูุฑ ุขูฺู ูุงุฒ ุฏุงุฑุฏ:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, DataCollatorWithPadding

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
checkpoint = <span class="hljs-string">&quot;bert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> tokenizer(example[<span class="hljs-string">&quot;sentence1&quot;</span>], example[<span class="hljs-string">&quot;sentence2&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)
data_collator = DataCollatorWithPadding(tokenizer=tokenizer)<!-- HTML_TAG_END --></pre></div></div>
<h3 id="">ุชุนูู</h3>
<p>ูุจู ุงุฒ ุงู ฺฉู ุจุชูุงูู <code>Trainer</code> ูุงู ุฑุง ุชุนุฑู ฺฉูู ุงููู ูุฑุญูู ุชุนุฑู ฺฉูุงุณ <code>TrainingArguments</code> ูโุจุงุดุฏ ฺฉู ุดุงูู ููู ูพุงุฑุงูุชุฑูุง ุณุทุญ ุจุงูุง ุงุณุช ฺฉู <code>Trainer</code> ุจุฑุง <code>Training</code> ู <code>Evaluation</code> ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ. ุชููุง ุขุฑฺฏููุงู ฺฉู ุดูุง ุจุงุฏ ุงุฑุงุฆู ฺฉูุฏ ุขุฏุฑุณ ุงุณุช ฺฉู ูุฏู ุชุนูู ุฏุฏู ุจู ููุฑุงู ููุงุท ุชุนูู ุฏุฑ ุขู ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ. ุจูู ูพุงุฑุงูุชุฑูุง ุฑุง ูโุชูุงูุฏ ุจู ุญุงูุช ูพุดโูุฑุถ ุฑูุง ฺฉูุฏุ ฺฉู ุจุฑุง ฺฉูฺฉ ฺฉุฑุฏู ูพุงู ุจู ุฎูุจ ฺฉุงุฑ ุฎูุงูุฏ ฺฉุฑุฏ. </p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

training_args = TrainingArguments(<span class="hljs-string">&quot;test-trainer&quot;</span>)<!-- HTML_TAG_END --></pre></div></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>๐ก ุงฺฏุฑ ูุงูุฏ ูุฏูโุชุงู ุฑุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ุญู ุชุนูู ุฏุฑ ูุงุจ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏุ ูพุงุฑุงูุชุฑ <code>push_to_hub=True</code> ุฑุง ุฏุฑ <code>TrainingArguments</code> ุงุฑุณุงู ฺฉูุฏ. ุฏุฑ <a href="/course/chapter4/3">ูุตู ด</a> ุฏุฑ ุงู ุจุงุฑู ุจุดุชุฑ ุฎูุงูู ุขููุฎุช.</p></div>
<p>ูุฑุญูู ุฏูู ุชุนุฑู ูุฏูโูุงู ูโุจุงุดุฏ. ูุงููุฏ <a href="/course/chapter2">ูุตู ูุจู</a>ุ ุงุฒ ฺฉูุงุณ <code>AutoModelForSequenceClassification</code> ุจุง ุฏู ุจุฑฺุณุจ ฺฉูุงุณ ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForSequenceClassification

model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div></div>
<p>ุดูุง ูุชูุฌู ุฎูุงูุฏ ุดุฏ ฺฉู ุจุฑุฎูุงู <a href="/course/chapter2">ูุตู ฒ</a>ุ ุจุนุฏ ุงุฒ ุณุงุฎุชู ุงู ูุฏู ุงุฒ ูพุดโ ุชุนูู ุฏุฏู ฺฉ ูุดุฏุงุฑ ุฏุฑุงูุช ูโฺฉูุฏ. ุงู ุจู ุงู ุฎุงุทุฑ ุงุณุช ฺฉู BERT ุจุฑุง ุฏุณุชูโุจูุฏ ุฏู ุฌูููโูุง ุงุฒ ูพุดโ ุชุนูู ูุฏุฏู ุงุณุชุ ุจูุงุจุฑุงู ูุงู ุณูุฑ ูุฏู ุงุฒ ูพุดโ ุชุนูู ุฏุฏู ุญุฐู ุดุฏู ู ฺฉ ูุงู ุณูุฑ ููุงุณุจ ุฌูุช ุฏุณุชู ุจูุฏ ุฑุดุชูโโโูุง ุจู ุฌุง ุขู ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช. ูุดุฏุงุฑูุง ูุดุงู ูโุฏููุฏ ฺฉู ุจุฑุฎ ุงุฒ ูุฒูโูุง ูุฏู ุงุณุชูุงุฏู ูุดุฏูโุงูุฏ (ุขููุง ฺฉู ูุฑุจูุท ุจู ูุงูโ ุณูุฑ ุญุฐู ุดุฏู ูุฏู ุงุฒ ูพุด ุชุนูู ุฏุฏู ูุณุชูุฏ) ู ุจุฑุฎ ุฏฺฏุฑ ุจู ุตูุฑุช ุชุตุงุฏู ููุฏุงุฑโ ุฏู ุดุฏูโโุงูุฏ (ุขููุง ฺฉู ูุฑุจูุท ุจู ูุงูโ ุณูุฑ ุฌุฏุฏ ูุณุชูุฏ). ุฏุฑ ูุชุฌู ุงู ุงูุฑ ุดูุง ุฑุง ุชุดูู ุจู ุชุนูู ูุฏู ูโฺฉูุฏุ ฺฉู ุฏููุง ููุงู ฺฉุงุฑ ุงุณุช ฺฉู ูโุฎูุงูู ุงฺฉููู ุงูุฌุงู ุฏูู.</p>
<p>ุจู ูุญุถ ุงูฺฉู ูุฏูโูุงู ูุดุฎุต ุดุฏ ูโุชูุงูู <code>Trainer</code> ุฑุง ุจุง ุงุฑุณุงู ููู ุงุดุงุฆ ฺฉู ุชุง ฺฉููู ุณุงุฎุชู ุดุฏูโุงูุฏ - <span dir="ltr"><code>model</code></span>ุ <span dir="ltr"><code>training_args</code></span>ุ ุฏุชุงุณูุชโูุง <span dir="ltr"><code>training</code></span> ู <span dir="ltr"><code>validation</code></span>ุ <span dir="ltr"><code>data_collator</code></span> ู <span dir="ltr"><code>tokenizer</code></span> ุจู ุฏุงุฎู ุขู ุชุนุฑู ฺฉูู:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
)<!-- HTML_TAG_END --></pre></div></div>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ุฒูุงู ฺฉู <code>tokenizer</code> ุฑุง ุงุฑุณุงู ูโฺฉูุฏุ ูุซู ฺฉุงุฑ ฺฉู ูุง ุฏุฑ ุงูุฌุง ุงูุฌุงู ุฏุงุฏูุ <code>data_collator</code> ูพุดโูุฑุถ ููุฑุฏ ุงุณุชูุงุฏู <code>Trainer</code>ุ ููุงูุทูุฑ ฺฉู ูุจูุง ุชุนุฑู ฺฉุฑุฏูุ <code>DataCollatorWithPadding</code> ุฎูุงูุฏ ุจูุฏุ ุฏุฑ ุชูุฌู ุดูุง ูโุชูุงูุฏ ุฎุท <code>data_collator=data_collator</code> ุฑุง ุฏุฑ ุงู ูุฑุงุฎูุงู ูุงุฏุฏู ุจฺฏุฑุฏ. ุงู ูููุฒ ููู ุจูุฏ ฺฉู ุงู ุจุฎุด ุงุฒ ูพุฑุฏุงุฒุด ุฑุง ุฏุฑ ุจุฎุด ฒ ุจู ุดูุง ูุดุงู ุฏูู!</p>
<p>ุจุฑุง ฺฉูฺฉ ฺฉุฑุฏู ูุฏู ุฑู ุฏุชุงุณูุชโูุงู ูุง ููุท ุจุงุฏ ุชุงุจุน <span dir="ltr"><code>train()</code></span> ุงุฒ <code>Trainer</code>ูุงู ุฑุง ุตุฏุง ุจุฒูู:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train()<!-- HTML_TAG_END --></pre></div></div>
<p>ุงู ฺฉุงุฑุ ฺฉูฺฉ ฺฉุฑุฏู ุฑุง ุดุฑูุน ูโฺฉูุฏ (ฺฉู ุจุงุฏ ฺูุฏ ุฏููู ุฑู GPU ุทูู ุจฺฉุดุฏ) ู ูุฒูู ุชุนูู ุฑุง ูุฑ ตฐฐ ูุฑุญูู ฺฉโุจุงุฑ ฺฏุฒุงุฑุด ูโฺฉูุฏ. ุจุง ุงู ุญุงู ุจู ุดูุง ููโฺฏูุฏ ฺฉู ูุฏูโุชุงู ฺูุฏุฑ ุฎูุจ (ุง ุจุฏ) ุนูู ูโฺฉูุฏ. ุงู ุจู ุงู ุฎุงุทุฑ ุงุณุช ฺฉู:</p>
<p>ฑ. ูุง ุจู <code>Trainer</code> ูฺฏูุชู ฺฉู ุฏุฑ ุญู ุชุนูู ฺฉูุช ูุฏู ุฑุง ุงูุฏุงุฒูโฺฏุฑ ฺฉูุฏ. ฺฉุงุฑ ฺฉู ูโุชูุงูุณุชู ุจุง ููุฏุงุฑุฏู ูพุงุฑุงูุชุฑ <code>evaluation_strategy</code> ุจู <code>&quot;steps&quot;</code> (ุจุฑุง ุงุฑุฒุงุจ ุฏุฑ ูุฑ <code>eval_steps</code>) ุง ุจู <code>&quot;epoch&quot;</code> (ุจุฑุง ุงุฑุฒุงุจ ุฏุฑ ุงูุชูุง ูุฑ epoch) ุงูุฌุงู ุฏูู.</p>
<p>ฒ. ูุง ุชุงุจุน <span dir="ltr"><code>compute_metrics()</code></span> ุฑุง ุจุฑุง <code>Trainer</code> ูุฑุงูู ูฺฉุฑุฏู ุชุง ุจุชูุงูุฏ ูุนุงุฑูุง ุฑุง ุฏุฑ ุญู ุงุตุทูุงุญุง ุงุฑุฒุงุจ ูุญุงุณุจู ฺฉูุฏ (ฺฉู ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุงุฑุฒุงุจ ููุท ูุฒูู ุฑุง ฺุงูพ ูโฺฉูุฏ ฺฉู ุนุฏุฏ ฺูุฏุงู ฺฏูุง ูู ูุณุช) .</p>
<h3 id="">ุงุฑุฒุงุจ</h3>
<p>ุงุฌุงุฒู ุฏูุฏ ุจุจูู ฺฺฏููู ูโุชูุงูู ุชุงุจุน <span dir="ltr"><code>compute_metrics()</code></span> ููุฏ ุจุณุงุฒู ู ุฏุฑ ุชุนูู ุจุนุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู. ุชุงุจุน ุจุงุฏ ฺฉ ุดุก <code>EvalPrediction</code> ุฏุฑุงูุช ฺฉูุฏ (ฺฉู ุชุงูพู ุงุณุช ุดุงูู ููุฏูุง <code>predictions</code> ู <code>label_ids</code>) ู ฺฉ ุฏฺฉุดูุฑ ุจุงุฒ ฺฏุฑุฏุงูุฏ ฺฉู ุฑุดุชูโูุง ูุชู ุฑุง ุจู ุงุนุฏุงุฏ ุญูู ุชุจุฏู ูโฺฉูุฏ (ุฑุดุชูโูุง ูุชู ูุงู ูุนุงุฑูุง ุจุงุฒฺฏุฑุฏุงูุฏู ุดููุฏู ู ุงุนุฏุงุฏ ุญูู ููุงุฏุฑ ุขูโูุง ู ุจุงุดูุฏ). ุจุฑุง ุงุณุชุฎุฑุงุฌ ฺูุฏ ูพุดโุจูโ ุงุฒ ูุฏูโูุงูุ ูโุชูุงูู ุงุฒ ุฏุณุชูุฑ <span dir="ltr"><code>Trainer.predict()</code></span> ุงุณุชูุงุฏู ฺฉูู:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions = trainer.predict(tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>])
<span class="hljs-built_in">print</span>(predictions.predictions.shape, predictions.label_ids.shape)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">408</span>, <span class="hljs-number">2</span>) (<span class="hljs-number">408</span>,)<!-- HTML_TAG_END --></pre></div></div>
<p>ุฎุฑูุฌ ุชุงุจุน <span dir="ltr"><code>predict()</code></span> ุชุงูพู ูุงู ฺฏุฐุงุฑ ุดุฏู ุฏฺฏุฑ ุดุงูู ุณู ููุฏ: <code>predictions</code>ุ <code>label_ids</code> ู <code>metrics</code> ูโุจุงุดุฏ. ููุฏ <code>metrics</code> ููุท ุดุงูู ูุฒูู ุฏุงุฏู ุนุจูุฑ ฺฉุฑุฏู ู ุจุฑุฎ ูุนุงุฑูุง ุฒูุงู (ูพุดโุจูโุ ุฏุฑ ูุฌููุน ู ุจู ุทูุฑ ูุงูฺฏูุ ฺูุฏุฑ ุทูู ฺฉุดุฏู) ูโุจุงุดุฏ. ุจู ูุญุถ ุงู ฺฉู ุชุงุจุน <span dir="ltr"><code>compute_metrics()</code></span> ุฑุง ฺฉุงูู ฺฉุฑุฏู ู ุขู ุฑุง ุจู <code>Trainer</code> ุงุฑุณุงู ฺฉููุ ุขู ููุฏ ูุชุฑฺฉโูุง ุจุงุฒฺฏุดุช ุงุฒ <span dir="ltr"><code>compute_metrics()</code></span> ุฑุง ูุฒ ุฏุฑ ุจุฑ ุฎูุงูุฏ ุฏุงุดุช.</p>
<p>ููุงูุทูุฑ ฺฉู ูโุจูุฏุ <code>predictions</code> ุขุฑุงูโุง ุฏู ุจุนุฏ ุงุณุช ุจุง ุดฺฉู <span dir="ltr">ดฐธ x ฒ</span> (ฺฉู ดฐธ ุชุนุฏุงุฏ ุนูุงุตุฑ ุฏุฑ ุฏุชุงุณูุช ููุฑุฏ ุงุณุชูุงุฏูโ ูุง ูโุจุงุดุฏ). ุงู ูุง logits ูุฑุจูุท ุจู ูุฑฺฉ ุงุฒ ุนูุงุตุฑ ุฏุชุงุณูุช ูุณุชูุฏ ฺฉู ูุง ุจู ุชุงุจุน <span dir="ltr"><code>predict()</code></span> ุงุฑุณุงู ฺฉุฑุฏู (ููุงูุทูุฑ ฺฉู ุฏุฑ <a href="/course/chapter2">ูุตู ูุจู</a> ุฏุฏุฏุ ููู ูุฏูโูุง ุชุฑููุณููุฑููุฑ logits ุฑุง ุจุงุฒ ูโฺฏุฑุฏุงููุฏ). ุจุฑุง ุชุจุฏู logits ุจู ูพุดโุจูโโูุง ฺฉู ุจุชูุงูู ุจุง ุจุฑฺุณุจโูุงูุงู ููุงุณู ฺฉููุ ูุงุฒ ุฏุงุฑู ุงูุฏุณ ููุฏุงุฑ ุจุดูู ุฑู ุจุนุฏ ุฏูู ุฑุง ุจุฑุฏุงุฑู: </p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

preds = np.argmax(predictions.predictions, axis=-<span class="hljs-number">1</span>)<!-- HTML_TAG_END --></pre></div></div>
<p>ุงฺฉููู ูโุชูุงูู <code>preds</code> ุฑุง ุจุง ุจุฑฺุณุจโูุง ููุงุณู ฺฉูู. ุจุฑุง ุณุงุฎุชู ุชุงุจุน <span dir="ltr"><code>compute_metric()</code></span>ุ ุจู ูุชุฑฺฉโูุง ฺฉุชุงุจุฎุงูู ุฏุงุฏูโูุง ูุงฺฏูฺฏโููุณ ุชฺฉู ุฎูุงูู ฺฉุฑุฏ. ูุง ูโุชูุงูู ูุชุฑฺฉโูุง ูุงุจุณุชู ุจู ุฏุชุงุณูุช MRPC ุฑุง ุจู ุฑุงุญุช ุฎูุฏ ุฏุชุงุณูุชุ ุงูุง ุงู ุจุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน <span dir="ltr"><code>load_metric()</code></span>ุ ุจุงุฑฺฏุฐุงุฑ ฺฉูู. ุดุก ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏู ุชุงุจุน ุจู ูุงู <span dir="ltr"><code>compute()</code></span> ุฏุงุฑุฏ ฺฉู ูโุชูุงูู ุจุฑุง ูุญุงุณุจู ูุชุฑฺฉ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_metric

metric = load_metric(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
metric.compute(predictions=preds, references=predictions.label_ids)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8578431372549019</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8996539792387542</span>}<!-- HTML_TAG_END --></pre></div></div>
<p>ุงุฒ ุขูุฌุง ฺฉู ููุฏุงุฑุฏู ุชุตุงุฏู ุงููู ูุฏู ูโุชูุงูุฏ ูุชุฑฺฉโูุง ููุง ุฑุง ุชุบุฑ ุฏูุฏุ ูุชุงุฌ ุฏูู ฺฉู ุดูุง ุจุฏุณุช ูโุขูุฑุฏ ููฺฉู ุงุณุช ูุชูุงูุช ุจุงุดุฏ. ุฏุฑ ุงูุฌุง ูโุชูุงูู ุจุจูู ฺฉู ูุฏู ูุง <code>accuracy</code> ูุนุงุฏู ธต.ทธูช ู <code>F1 Score</code> ูุนุงุฏู ธน.นทูช ุฑู ูุฌููุนู <code>validation</code> ุจุฏุณุช ูโุขูุฑุฏ. ุขููุง ุฏู ูุชุฑฺฉ ุจุฑุง ุงุฑุฒุงุจ ูุชุงุฌ ูุญฺฉ GLUE ุฑู ุฏุชุงุณูุช MRPC ูุณุชูุฏ. ุฌุฏูู ูุชุงุฌ ุฏุฑ ููุงูู <a href="https://arxiv.org/pdf/1810.04805.pdf" rel="nofollow">BERT</a>ุ ุจุฑุง ูุฏู ูพุงูุ  <code>F1 Score</code> ูุนุงุฏู ธธ.น ุฑุง ฺฏุฒุงุฑุด ูโฺฉูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุขู ูุฏู <code>uncased</code> ุจูุฏุ ุญุงู ุขู ฺฉู ุฏุฑ ุงูุฌุง ูุง ุงุฒ ูุฏู <code>cased</code> ุงุณุชูุงุฏู ูโฺฉููุ ฺฉู ุฏุณุชุงุจ ุจู ูุชุงุฌ ุจูุชุฑ ุฑุง ุชูุถุญ ูโุฏูุฏ.</p>
<p>ุงฺฉููู ุจุง ูุฑุงุฑ ุฏุงุฏู ููู ฺุฒ ฺฉูุงุฑูู ุชุงุจุน <span dir="ltr"><code>compute_metrics()</code></span> ุฑุง ุจุฏุณุช ุฎูุงูู ุขูุฑุฏ:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_preds</span>):
    metric = load_metric(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
    logits, labels = eval_preds
    predictions = np.argmax(logits, axis=-<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)<!-- HTML_TAG_END --></pre></div></div>
<p>ู ุฏุฑ ุงูุฌุง ูุดุงู ูโุฏูู ฺฉู ฺฺฏููู ฺฉ <code>Trainer</code> ุฌุฏุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน <span dir="ltr"><code>compute_metrics()</code></span> ุชุนุฑู ูโฺฉููุ ุชุง ุจุชูุงูู ุนููฺฉุฑุฏ ุขู ุฑุง ุฏุฑ ุญู ฺฏุฒุงุฑุด ูุชุฑฺฉโูุง ุฏุฑ ูพุงุงู ูุฑ epoch ูุดุงูุฏู ฺฉูู:  </p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->training_args = TrainingArguments(<span class="hljs-string">&quot;test-trainer&quot;</span>, evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)<!-- HTML_TAG_END --></pre></div></div>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ูุฏู ุฌุฏุฏ ู <code>TrainingArguments</code> ุฌุฏุฏ ฺฉู <code>evaluation_strategy</code> ุขู <code>&quot;epoch&quot;</code> ุงุณุช ูโุณุงุฒู - ุฏุฑ ุบุฑ ุงู ุตูุฑุช ููุท ุชุนูู ูุฏู ฺฉู ุงุฒ ูพุด ุชุนูู ุฏุฏู ุจูุฏ ุฑุง ุงุฏุงูู ูโุฏุงุฏู. ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุฏูุฑ ุฌุฏุฏ ุชุนููุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ูโฺฉูู:</p>
<div dir="ltr"><div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.trai<span class="hljs-meta">n</span>()<!-- HTML_TAG_END --></pre></div></div>
<p>ุงู ุจุงุฑ ูุฒูู validation ู ูุชุฑฺฉโูุง ุฑุง ุฏุฑ ูพุงุงู ูุฑ epoch ู ุฏุฑ ุจุงูุง ูุฒูู ุชุนูู ฺฏุฒุงุฑุด ูโฺฉูู. ุฏูุจุงุฑูุ ุจู ุฎุงุทุฑ ููุฏุงุฑ ุฏู ุชุตุงุฏู ุงููู ูุงู ุณุฑ ูุฏูุ ููุงุฏุฑ ุฏูู <span dir="ltr">accuracy/F1 score</span> ฺฉู ุดูุง ุจุฏุณุช ูโุขูุฑุฏ ููฺฉู ุงุณุช ฺฉู ูุชูุงูุช ุงุฒ ุขูฺู ูุง ุจุฏุณุช ุขูุฑุฏูโุงู ุจุงุดุฏุ ุงูุง ุงู ููุงุฏุฑ ุจุงุฏ ุฏุฑ ูุญุฏูุฏู ุชุฎูู ฺฉุณุงู ุจุงุดูุฏ.  </p>
<p>ุจู ุตูุฑุช ูพุด ูุฑุถุ <code>Trainer</code> ุฑู ฺูุฏู GPU ุง TPU ฺฉุงุฑ ุฎูุงูุฏ ฺฉุฑุฏ ู ฺฏุฒููโูุง ูุฑุงูุงูุ ูุซู ุชุนูู mixed-precision (ุงุฒ ููุฏุงุฑ <code>fp16 = True</code> ุฏุฑ ุขุฑฺฏููุงูโูุง ุชุนูู ุงุณุชูุงุฏู ฺฉูุฏ) ูุฑุงูู ูโฺฉูุฏ. ุฏุฑ ูุตู ฑฐ ููู ุญุงูุชโูุง ฺฉู ูพุดุชุจุงู ูโฺฉูุฏ ุฑุง ูุฑูุฑ ุฎูุงูู ฺฉุฑุฏ. </p>
<p>ุงู ูพุงุงู ููุฏููโุง ุจุฑ ฺฉูฺฉ ฺฉุฑุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ <code>Trainer</code> API ูโุจุงุดุฏ. ุฏุฑ <a href="/course/chapter7">ูุตู ท</a> ูุซุงู ุจุฑุง ูุดุงู ุฏุงุฏู ฺฺฏููฺฏ ุงูุฌุงู ุงู ฺฉุงุฑ ุจุฑุง ูุนูููโุชุฑู ูุณุฆููโูุง NLP ุงุฑุงุฆู ุฎูุงูู ฺฉุฑุฏุ ุงูุง ุงฺฉููู ุงุฌุงุฒู ุฏูุฏ ุจุจูู ฺฺฏููู ููู ฺฉุงุฑ ุฑุง ุตุฑูุง ุจุง ุงุณุชูุงุฏู ุงุฒ PyTorch ุงูุฌุงู ุฏูู. </p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>โ๏ธ <strong>ุงุชุญุงู ฺฉูุฏ!</strong> ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุฑุฏุงุฒุด ุฏุงุฏูโุง ฺฉู ุฏุฑ ุจุฎุด ฒ ุงูุฌุงู ุฏุงุฏุฏุ ูุฏู ุฑุง ุฑู ุฏุชุงุณูุช GLUE SST-2 ฺฉูฺฉ ฺฉูุฏ.</p></div></div>


		<script type="module" data-hydrate="ja2a7d">
		import { start } from "/docs/course/pr_264/fa/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="ja2a7d"]').parentNode,
			paths: {"base":"/docs/course/pr_264/fa","assets":"/docs/course/pr_264/fa"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/pr_264/fa/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/pr_264/fa/_app/pages/chapter3/3.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
